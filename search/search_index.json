{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"SMS API","text":""},{"location":"#introduction","title":"Introduction","text":"<p>HTTP Bulk Service API enables customers to send SMS over HTTP/HTTPS and to receive Delivery Reports (DLRs) over the same protocol.</p>"},{"location":"#help-with-formatting-special-types-of-messages","title":"Help with Formatting Special Types of Messages","text":"<p>Celetel HTTP Bulk Service API helps customers to format special types of messages, such as concatenated messages and WSI (WAP Service Indication) messages. HTTP Bulk Service API may split the submitted message into several physical SMS messages (concatenated messages) or reject the message because it is too long. Customer balance is charged per physical SMS, as in details described in the following text.</p>"},{"location":"#protocol-description","title":"Protocol Description","text":"<p>This chapter provides information about the supported types of bulk SMS messages and the data flow of the messages and delivery reports.</p> <p>It also provides information on the types of cases for the delivery status of the messages.</p>"},{"location":"#types-of-bulk-messages","title":"Types of Bulk Messages","text":"<p>Customers can send different types of messages:</p> <ul> <li>GSM Text messages</li> <li>Unicode Text Messages</li> <li>WAP Service Indicators (WSI)</li> </ul>"},{"location":"#data-flow-of-message-and-delivery-reports","title":"Data Flow of Message and Delivery Reports","text":"<p>The message is submitted over HTTP/HTTPS from the customer to Celetel HTTP Bulk Service API. When API has information on what happened with the delivery of the message (described in 2.5.2 Delivery Report Events section), it will send (also using HTTP/HTTPS) an event to the Callback DLR URL provided by the customer.</p> <p>There are four cases:</p> <ul> <li>Delivered message (DELIVERED)</li> <li>Undelivered message (UNDELIVERED)</li> <li>Rejected message (REJECTED)</li> <li>Buffered (temporary undelivered) message (BUFFERED) followed by final DLR event, delivered (DELIVERED), undelivered (UNDELIVERED) or rejected (REJECTED)</li> </ul> <p>When the message cannot be delivered as fast as possible due to temporary problems and if the DLR mask allows sending buffered events to customers for each delivery attempt, DLR event Buffered will be sent to the Callback DLR URL, as described in 2.2.4 Buffered (Temporary Undelivered Message) section.</p> <p>If the DLR mask does not allow sending DLR event Buffered to the customer, no notification will be provided until the final event, Delivered or Undelivered. When the message is delivered (at first attempt or at any latter attempt), DLR event Delivered will be sent, as described in 2.2.1 Delivered Message section.</p> <p>When the Bulk Service decides that a message cannot be delivered (at first attempt or at any latter attempt or when message validity expires), a DLR event Undelivered will be sent, as described in 2.2.2 Undelivered Message section.</p> <p>When the message is rejected immediately on submission, the customer will be informed with HTTP response about the reason, as described in 2.2.3 Rejected Message section. Rejection may also happen later, and the customer will be informed using DLR event Rejected.</p> <p>The following sections explain these cases more in detail.</p>"},{"location":"#delivered-message","title":"Delivered Message","text":"<p>When a customer submits an SMS to Celetel Bulk System, the message will be delivered to its destination as fast as possible. When Celetel Bulk System receives confirmation from a destination that the message is delivered, it will send a DLR Event Delivered to Callback DLR URL.</p>"},{"location":"#undelivered-message","title":"Undelivered Message","text":"<p>This case is similar to Delivered Message except it describes a failure in delivery. Callback DLR URL will be called with DLR event Undelivered and a reason. No further attempt to deliver will be made. Messages are undelivered in cases when:</p> <ul> <li>The destination number does not represent an existing mobile phone.</li> <li>There is no route to the required destination.</li> <li>If Celetel Bulk System was not able to deliver the message to the phone during the validity period (which is by default 24 hours).</li> <li>In case of some other permanent error that makes a delivery to mobile phone impossible.</li> </ul>"},{"location":"#rejected-message","title":"Rejected Message","text":"<p>Messages can be rejected by Celetel Bulk System in several cases:</p> <ul> <li>When the username and/or password submitted in the request don't match the one configured for the account.</li> <li>When the account is disabled.</li> <li>When there is no money on the account balance.</li> <li>When the destination is not allowed for the customer.</li> <li>When the sender field contains not allowed characters.</li> <li>When the format of any parameter is not correct.</li> <li>When the contents of some parameter (for example parameter text for text message submission) contains characters not supported with selected data coding.</li> <li>Rejection can happen: <ul> <li>immediately on submission, in which case the error will be returned to the customer with HTTP/HTTPS response on the submission request.</li> <li>or it can happen later, in which case the Callback DLR URL will be called with the DLR event Rejected.</li> </ul> </li> </ul> <p>Data flow for the message that is rejected later, after successful submission:</p>"},{"location":"#buffered-temporary-undelivered-message","title":"Buffered (Temporary Undelivered) Message","text":"<p>If Celetel HTTP Bulk Service cannot deliver the message at the first attempt, and the DLR mask allows sending of buffered messages to the customer, DLR will be sent to the customer for each attempt with the reason of temporary failed delivery.</p> <p>Reasons for temporary failures can be:</p> <ul> <li>Absent subscriber (subscriber is not within reach of destination network or his phone is offline).</li> <li>The mobile phone buffer for SMS is full.</li> <li> <p>Any other temporary failures of mobile device or destination mobile network when there is a chance to be resolved within the message validity period. Celetel Bulk System will stop trying to deliver the message in the following situations:</p> </li> <li> <p>The message is successfully delivered, in which case the DLR event Delivered is sent.</p> </li> <li>A permanent error happened which makes delivery impossible (e.g. the destination number does not exist). DLR event Undelivered or Rejected is sent.</li> <li>Message validity period expired - within the validity period, Celetel Bulk System was not able to deliver the message to the mobile phone. DLR event Undelivered or Rejected is sent.</li> </ul>"},{"location":"#sending-sms","title":"Sending SMS","text":"<p>Messages are sent using POST HTTP Method, to the URLs provided together with the credentials.</p> <p>HTTP Post JSON payload must be encoded using UTF-8 encoding.</p>"},{"location":"#json-fields-in-submitted-message","title":"JSON Fields in Submitted Message","text":"<p>JSON fields in submitted message, common for all types:</p> Name Type Description type string Type of a message. It can be: text or wsi. For type='text':- text - UTF-8 encoded text of message content,- dcs - message coding, gsm (for GSM messages) or ucs (for Unicode messages).For type='wsi':- url - URL to show in WSI,- title - Title of WSI. sender string SMS originator address, alphanumeric or numeric. receiver string SMS destination address, numeric. dlrMask integer DLR mask represents DLRs customer wants to receive, described in the following text (optional, default=19). dlrUrl string DLR URL where to send DLR callbacks (optional, if not present, the one set in an account settings in the platform is used). custom object Custom JSON object that will be sent back as a part of each DLR (optional, default empty). auth object Authentication object with two fields:username - account usernamepassword - account password."},{"location":"#example-of-submission-urls","title":"Example of Submission URLs","text":"For HTTP<pre><code>http://sms.Celetel.info:12020/bulk/sendsms\n</code></pre> For HTTPS<pre><code>https://sms.Celetel.info:12021/bulk/sendsms\n</code></pre>"},{"location":"#text-messages-in-gsm-encoding","title":"Text Messages in GSM Encoding","text":"<p>SMS to be sent is encoded in JSON document:</p> <p><pre><code>{\n\"type\": \"text\",\n\"auth\": {\"username\": \"testuser\", \"password\": \"testpassword\"},\n\"sender\": \"BulkTest\",\n\"receiver\": \"4179123456\",\n\"dcs\": \"GSM\",\n\"text\": \"This is test message\",\n\"dlrMask\": 19,\n\"dlrUrl\": \"http://my-server.com/dlrjson.php\"\n}\n</code></pre> and it must be submitted to the URL (HTTP or HTTPS) that is given together with the credentials.</p>"},{"location":"#examples-from-bash-shell","title":"Examples (From Bash Shell)","text":"For HTTP<pre><code>CONTENT='{\n\"type\": \"text\", \"auth\": {\"username\": \"testuser\", \"password\": \"testpassword\"}, \"sender\": \"BulkTest\",\n\"receiver\": \"41787078880\", \"dcs\": \"GSM\", \"text\": \"This is test message\", \"dlrMask\": 19, \"dlrUrl\": \"http://my-server.com/dlrjson.php\"\n}'\ncurl -L \"http://sms.Celetel.info:12020/bulk/sendsms\" -XPOST -d \"$CONTENT\"\n</code></pre> For HTTPS<pre><code>CONTENT='{\n\"type\": \"text\", \"auth\": {\"username\": \"testuser\", \"password\": \"testpassword\"}, \"sender\": \"BulkTest\",\n\"receiver\": \"41787078880\", \"dcs\": \"GSM\", \"text\": \"This is test message\", \"dlrMask\": 19, \"dlrUrl\": \"http://my-server.com/dlrjson.php\"\n}'\ncurl -L \"https://sms.Celetel.info:12021/bulk/sendsms\" -XPOST -d \"$CONTENT\"\n</code></pre>"},{"location":"#unicode-messages","title":"Unicode Messages","text":"<pre><code>{\n\"type\": \"text\",\n\"auth\": {\"username\": \"testuser\", \"password\": \"testpassword\"},\n\"sender\": \"BulkTest\",\n\"receiver\": \"4179123456\",\n\"dcs\": \"UCS\",\n\"text\": \"This is test message with some UTF-8 characters \u00fc\u00f6\u00e4\u20ac \",\n\"dlrMask\": 19,\n\"dlrUrl\": \"http://my-server.com/dlrjson.php\"\n}\n</code></pre> <p>Message text must be UTF-8 encoded as well, but it will be sent to the destination device encoded using UTF-16 protocol. Content is converted by Bulk Service.</p> <p>Note that GSM messages, when long, need to be encoded to 140 bytes or 160 septets when content is converted to GSM encoding. Available number of bytes is further reduced by the length of the UDH (used for concatenation). Unicode messages use the same number of bytes (140) but require more bytes for each character (UTF-16 encoding). This means, when message content is longer, and must be sent as concatenated parts, Unicode messages will require more parts than GSM messages.</p>"},{"location":"#wap-server-indication-wsi-messages","title":"WAP Server Indication (WSI) Messages","text":"<pre><code>{\n\"type\": \"wsi\",\n\"auth\": {\"username\": \"6666_TESTHTTP\", \"password\": \"TerWAvAs\"},\n\"sender\": \"BulkTest\",\n\"receiver\": \"41787078880\",\n\"url\": \"https://www.Celetel.com/en/\",\n\"title\": \"Celetel\",\n\"dlrMask\": 19,\n\"dlrUrl\": \"http://my-server.com/dlrjson.php\"\n}\n</code></pre>"},{"location":"#http-response-when-sending-sms","title":"HTTP Response When Sending SMS","text":"<p>Sucesss</p> <p>If the message is accepted to be sent, HTTP status code is 202 and JSON response is:   </p> <pre><code>{\n\"msgId\": \"9325d0a8-2638-11e6-afe7-bffc7cc8fa4f\",\n\"numParts\": 2\n}\n</code></pre> <p>Where:</p> <ul> <li>msgId - message ID formatted as UUID and used for referencing further this message, for example in DLR.</li> <li>numParts - number of parts if the message is concatenated. If the message can be sent as one SMS part (without concatenation), numParts will be 1.</li> </ul> <p>Failure</p> <p>If the message is rejected, the HTTP status code is 420 and the response is:</p> <pre><code>{\n\"error\": {\n\"code\": \"107\",\n\"message\": \"Invalid sender\"\n}\n}\n</code></pre> <p>API may also return other error codes from the 5xx range. In this case, there is no JSON response and error codes conform to standard HTTP error codes.</p>"},{"location":"#error-codes","title":"Error Codes","text":"<p>Error codes are listed in the following table:</p> Error code Value Description RC_APPLICATION_ERROR 101 Internal application error. RC_ENCODING_ERROR 102 Encoding not supported or message not encoded with selected encoding. RC_NO_ACCOUNT 103 No account with given username/password. RC_IP_NOT_ALLOWED 104 Sending from clients IP address not allowed. RC_THROTTLING_ERROR 105 Too many messages were submitted within a short period of time. Resend later. RC_BLACKLISTED_SENDER 106 Sender contains words blacklisted on destination. RC_INVALID_SENDER 107 Sender contains illegal characters. RC_MESSAGE_TOO_LONG 108 The message is too long. RC_BAD_CONTENT_FORMAT 109 The format of the text parameter is wrong. RC_MISSING_MANDATORY_PARAMETER 110 Mandatory parameter is missing. RC_UNKNOWN_MESSAGE_TYPE 111 Unknown message type. RC_BAD_PARAMETER_VALUE 112 Format of some parameter is wrong. RC_NO_CREDIT 113 No credit on account balance. RC_NO_ROUTE 114 No route for given destination. RC_CONCAT_ERROR 115 Message cannot be split into concatenated messages (e.g. too many parts will be needed). RC_LOOP_DETECTED 116 Loop detected."},{"location":"#how-to-handle-errors","title":"How to Handle Errors","text":"<p>When the customer receives an HTTP status code 420 METHOD_INVOCATION_FAILURE, he should not retry the submission of the message, except in the case of RC_THROTTLING_ERRO</p> <p>Throttling Error</p> <p>In case when submission fails with RC_THROTTLING_ERROR, the customer should wait one second and then retry the submission.</p> <p>Internal server Error</p> <p>In case when submission fails with HTTP status code 500 INTERNAL_SERVER_ERROR, the customer should wait at least one minute and then retry the submission.</p>"},{"location":"#receiving-dlr","title":"Receiving DLR","text":"<p>Delivery reports are sent to the customer to the URL provided in JSON field \"dlrUrl\" when submitting an SMS. Alternatively, the account could be set up with a default value for \"dlrUrl\".</p> <p>It is JSON encoded, with the following form:</p> <p><pre><code>{\n\"msgId\": \"9325d0a8-2638-11e6-afe7-bffc7cc8fa4f\",\n\"event\": \"DELIVERED\",\n\"errorCode\": 0,\n\"errorMessage\": \"\",\n\"partNum\": 1,\n\"numParts\": 2,\n\"accountName\": \"testuser\",\n\"sendTime\u201d: 0,\n    \"dlrTime\": 2\n}\n</code></pre> Fields in DLR:</p> Name Type Description msgId string ID of the message, the one returned when SMS is submitted. event string One of DELIVERED, UNDELIVERED, REJECTED, BUFFERED, SENT_TO_SMSC. errorCode integer Error code, a reason for delivery failure (check DLR error code list in the next section). Zero represents no error. errorMessage string A message associated with errorCode. numParts integer Total number of concatenated parts. If message is not concatenated then numParts=1. partNum integer A part number. It can be from [0..numParts-1] interval. sendTime integer Seconds passed from SMS submission until Bulk Service successfully sent SMS to the route (next hop). dlrTime integer Seconds passed from SMS being sent to the route (next hop) until the delivery report was received. <p>Depending on an account settings, DLR may contain additional fields:</p> <ul> <li>mcc - Mobile Country Code discovered for the destination number.</li> <li>mnc - Mobile Network Code discovered for the destination number.</li> <li>country - ISO2 code of the country where the destination number is registered.</li> <li>price - The price of the SMS (this information is informal and may be subject to change).</li> <li>currency - The currency of the price.</li> </ul> <p>If SMS is submitted with \"custom\" field, DLR will have:</p> <ul> <li>custom - The same object sent back in each DLR.</li> </ul> <p>When a message is concatenated, it is submitted by the customer as one submission, and then split by Bulk Service to required number of SMS parts. DLRs are sent to the Callback URL for each SMS part independently.</p>"},{"location":"#dlr-error-codes","title":"DLR Error Codes","text":"<p>DLR error codes are given in the following table:</p> Value (dec) Description 0 No error 1 Unknown subscriber 9 Illegal subscriber 11 Teleservice not provisioned 13 Call barred 15 CUG reject 19 No SMS support in MS 20 Error in MS 21 Facility not supported 22 Memory capacity exceeded 29 Absent subscriber 30 MS busy for MT SMS 36 Network/Protocol failure 44 Illegal equipment 60 No paging response 61 GMSC congestion 63 HLR timeout 64 MSC/SGSN timeout 70 SMRSE/TCP error 72 MT congestion 75 GPRS suspended 80 No paging response via MSC 81 IMSI detached 82 Roaming restriction 83 Deregistered in HLR for GSM 84 Purged for GSM 85 No paging response via SGSN 86 GPRS detached 87 Deregistered in HLR for GPRS 88 The MS purged for GPRS 89 Unidentified subscriber via MSC 90 Unidentified subscriber via SGSN 112 Originator missing credit on prepaid account 113 Destination missing credit on prepaid account 114 Error in prepaid system 500 Other error 990 HLR failure 991 Rejected by message text filter 992 Ported numbers not supported on destination 993 Blacklisted sender 994 No credit 995 Undeliverable 996 Validity expired 997 Blacklisted receiver 998 No route 999 Repeated submission (possible looping) <p>Delivery error codes are very often unreliable because of a lack of standards in messaging protocols. Bulk Service tries to provide the best effort to unify error code values. Error codes returned by underlying routes are mapped to the above table.</p>"},{"location":"#delivery-report-events","title":"Delivery Report Events","text":"<p>Delivery events that Celetel Bulk Service sends to the Callback are:</p> Name DLR mask value Description DELIVERED 1 Delivered to phone, final status. UNDELIVERED 2 Non-Delivered to Phone, final status. BUFFERED 4 Queued on SMSC, temporary status. SENT_TO_SMSC 8 Delivered to SMSC, temporary status. REJECTED 16 Non-Delivered to SMSC, final status. <p>Statuses described with 'final status' are final delivery reports \u2013 no further delivery reports will be sent for the message. Statuses described with 'temporary status' are of two kinds:</p> <ul> <li>Queued on SMSC usually means that there was some problem delivering the message to the mobile phone, and further DLRs will follow.</li> <li>Queued on SMSC means that Celetel Bulk Service sent the message to the destination network.</li> </ul> <p>DLR Mask set for each sent message can be a combination of these values. For example, 1+2+16=19 means that all the final statuses will be reported (DELIVERED, UNDELIVERED, REJECTED). DLR Mask 19 is recommended.</p> <p>Temporary statuses are not always available, and it may depend on various criteria when they can be sent.</p>"},{"location":"#additional-tables","title":"Additional Tables","text":""},{"location":"#gsm-character-set","title":"GSM character set","text":"Dec 0 16 32 48 64 80 96 112 Hex 0 10 20 30 40 50 60 70 0 0 @ \u0394 SP 0 \u00a1 P p 1 1 \u00a3 _ ! 1 A Q a q 2 2 $ \u03a6 \u201c 2 B R b r 3 3 \u00a5 \u0393 # 3 C S c s 4 4 \u00e8 \u039b \u00a4 4 D T d t 5 5 \u00e9 \u03a9 % 5 E U e u 6 6 \u00f9 \u03a0 &amp; 6 F V f v 7 7 \u00ec \u03a8 \u2018 7 G W g w 8 8 \u00f2 \u03a3 ( 8 H X h x 9 9 \u00c7 \u0398 ) 9 I Y i y 10 A LF \u039e * : J Z j z 11 B \u00d8 + ; K \u00c4 k \u00e4 12 C \u00f8 \u00c6 , &lt; L \u00d6 l \u00f6 13 D CR \u00e6 - = M \u00d1 m \u00f1 14 E \u00c5 . &gt; N \u00dc n \u00fc 15 F \u00e5 \u00c9 / ? O \u00a7 o \u00e0 <p>Additional characters on GSM phones (in conversion to GSM character set counted as two characters):</p> You want to send ASCII Send the following Character Decimal Hex Characters Hex Decimal \u20ac  e 1B 65 27 101 10 0C 1B 0A 27 10 [ 91 5B  &lt; 1B 3C 27 60 \\ 92 5C  / 1B 2F 27 47 ] 93 5D  &gt; 1B 3E 27 62 ^ 94 5E  ^ 1B 14 27 20 { 123 7B  ( 1B 28 27 40 | 124 7C  @ 1B 40 27 64 } 125 7A  ) 1B 29 27 41 ~ 126 7E  = 1B 3D 27 61"},{"location":"#supported-characters-in-alphanumeric-sender","title":"Supported Characters in Alphanumeric Sender","text":"<p>When the SMS sender is alphanumeric, it can contain characters in the printable ASCII set, but depending on the destination being used some characters may not work.</p> <p>The following tables give recommendations on which characters are typically supported.</p>"},{"location":"#special-characters","title":"Special characters","text":"Supported Not Supported Character ASCII Code Character ASCII Code SPACE 0\u00d720 $ 0\u00d724 ! 0\u00d721 @ 0\u00d740 \u201c 0\u00d722 [ 0x5B # 0\u00d723 \\ 0x5C % 0\u00d725 ] 0x5D &amp; 0\u00d726 ^ 0x5E \u2018 0\u00d727 _ 0x5F ( 0\u00d728 ` 0\u00d760 ) 0\u00d729 { 0x7B * 0x2A | 0x7C + 0x2B } 0x7D , 0x2C ~ 0x7E - 0x2D \u20ac . 0x2E / 0x2F : 0x3A ; 0x3B &lt; 0x3C = 0x3D &gt; 0x3E ? 0x3F"},{"location":"#supported-letters-and-digits","title":"Supported Letters and Digits","text":"<ul> <li>0123456789</li> <li>abcdefghijklmnopqrstuvwxyz</li> <li>ABCDEFGHIJKLMNOPQRSTUVWXYZ</li> </ul>"}]}